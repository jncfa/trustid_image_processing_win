#ifndef TRUSTID_FACE_NORMALIZATION_H_
#define TRUSTID_FACE_NORMALIZATION_H_

#include <opencv2/opencv.hpp>
#include <math.h>

namespace trustid
{
    namespace image
    {
        class HeadPoseEstimationResult
        {
        public:
            HeadPoseEstimationResult(cv::Vec3d rotationVector, cv::Vec3d translationVector) : rotationVector(rotationVector), translationVector(translationVector)
            {
                cv::Mat rotationMatrix;
                cv::Rodrigues(rotationVector, rotationMatrix);
            }

            cv::Vec3d getRotationVector()
            {
                return rotationVector;
            }

            cv::Vec3d getTranslationVector()
            {
                return translationVector;
            }

        private:
            cv::Vec3d rotationVector;
            cv::Vec3d translationVector;
        };

        namespace impl
        {
            class FaceNormalizer
            {
            public:
                FaceNormalizer();

                HeadPoseEstimationResult estimateHeadPose(const FaceDetectionResultEntry detectionResultEntry)
                {
                    throw std::runtime_error("Not implemented");
                }

                static int constexpr triangles[] = {2, 1, 41,
                                                    29, 40, 39,
                                                    27, 39, 21,
                                                    36, 1, 0,
                                                    1, 36, 41,
                                                    17, 36, 0,
                                                    24, 20, 19,
                                                    45, 26, 16,
                                                    15, 45, 16,
                                                    6, 5, 59,
                                                    54, 13, 12,
                                                    11, 54, 12,
                                                    22, 27, 21,
                                                    28, 29, 39,
                                                    27, 28, 39,
                                                    18, 36, 17,
                                                    3, 48, 4,
                                                    48, 5, 4,
                                                    5, 48, 59,
                                                    37, 40, 41,
                                                    20, 37, 19,
                                                    36, 37, 41,
                                                    37, 18, 19,
                                                    18, 37, 36,
                                                    25, 26, 45,
                                                    44, 25, 45,
                                                    25, 44, 24,
                                                    29, 35, 30,
                                                    35, 29, 47,
                                                    13, 35, 14,
                                                    54, 35, 13,
                                                    7, 58, 8,
                                                    58, 6, 59,
                                                    58, 7, 6,
                                                    22, 42, 27,
                                                    42, 28, 27,
                                                    29, 42, 47,
                                                    28, 42, 29,
                                                    48, 60, 59,
                                                    31, 3, 2,
                                                    31, 48, 3,
                                                    31, 2, 41,
                                                    40, 31, 41,
                                                    29, 31, 40,
                                                    31, 29, 30,
                                                    32, 31, 30,
                                                    40, 38, 39,
                                                    37, 38, 40,
                                                    38, 37, 20,
                                                    39, 38, 21,
                                                    38, 20, 21,
                                                    53, 54, 64,
                                                    53, 35, 54,
                                                    33, 32, 30,
                                                    46, 35, 47,
                                                    35, 46, 14,
                                                    44, 46, 47,
                                                    46, 44, 45,
                                                    15, 46, 45,
                                                    46, 15, 14,
                                                    67, 58, 59,
                                                    43, 42, 22,
                                                    43, 44, 47,
                                                    42, 43, 47,
                                                    50, 33, 51,
                                                    33, 50, 32,
                                                    49, 60, 48,
                                                    31, 49, 48,
                                                    49, 31, 32,
                                                    50, 49, 32,
                                                    60, 49, 59,
                                                    49, 67, 59,
                                                    33, 52, 51,
                                                    23, 43, 22,
                                                    23, 20, 24,
                                                    44, 23, 24,
                                                    43, 23, 44,
                                                    20, 23, 21,
                                                    23, 22, 21,
                                                    61, 50, 51,
                                                    49, 61, 67,
                                                    61, 49, 50,
                                                    34, 52, 33,
                                                    35, 34, 30,
                                                    34, 33, 30,
                                                    53, 34, 35,
                                                    52, 34, 53,
                                                    56, 10, 9,
                                                    56, 9, 8,
                                                    67, 66, 58,
                                                    66, 57, 58,
                                                    57, 66, 56,
                                                    58, 57, 8,
                                                    57, 56, 8,
                                                    61, 62, 67,
                                                    62, 66, 67,
                                                    62, 61, 51,
                                                    66, 65, 56,
                                                    62, 65, 66,
                                                    65, 55, 56,
                                                    56, 55, 10,
                                                    55, 53, 64,
                                                    55, 65, 53,
                                                    54, 55, 64,
                                                    55, 54, 11,
                                                    10, 55, 11,
                                                    63, 52, 53,
                                                    65, 63, 53,
                                                    63, 65, 62,
                                                    52, 63, 51,
                                                    63, 62, 51};

                static double constexpr sparse_3d[] = {
                    -7.3687851e+01, 3.5889259e+01, -3.6352287e+01,
                    -7.0506302e+01, 1.0255576e+01, -3.2451157e+01,
                    -6.6811974e+01, -1.1511062e+01, -2.5741173e+01,
                    -6.3147331e+01, -2.7727528e+01, -1.7220570e+01,
                    -5.5111954e+01, -4.5349655e+01, -7.5244260e+00,
                    -4.2695366e+01, -5.8076263e+01, 7.5313005e+00,
                    -2.7739019e+01, -6.6503975e+01, 2.5452507e+01,
                    -1.6059996e+01, -6.9685669e+01, 4.0095554e+01,
                    1.8317483e-01, -7.1492279e+01, 4.3239929e+01,
                    1.6486452e+01, -6.9458687e+01, 4.0106384e+01,
                    2.8140299e+01, -6.6404716e+01, 2.5492374e+01,
                    4.3086857e+01, -5.8216908e+01, 7.5439806e+00,
                    5.6401417e+01, -4.4019836e+01, -7.3553791e+00,
                    6.3457203e+01, -2.8079008e+01, -1.7233988e+01,
                    6.6935997e+01, -1.1869132e+01, -2.5752338e+01,
                    7.0286079e+01, 9.9766359e+00, -3.2558353e+01,
                    7.3385956e+01, 3.5866966e+01, -3.6146362e+01,
                    -5.7115425e+01, 5.0523201e+01, 2.4281555e+01,
                    -4.9404324e+01, 5.6544228e+01, 3.6277321e+01,
                    -3.8727184e+01, 5.8460594e+01, 4.4252171e+01,
                    -2.9376768e+01, 5.7249542e+01, 4.8074844e+01,
                    -1.8471443e+01, 5.5277172e+01, 5.0395805e+01,
                    1.8092108e+01, 5.5479839e+01, 5.0305977e+01,
                    2.8775743e+01, 5.6551769e+01, 4.7531181e+01,
                    3.8293453e+01, 5.7804272e+01, 4.4210564e+01,
                    4.9862064e+01, 5.5833706e+01, 3.5787735e+01,
                    5.6700256e+01, 5.1307693e+01, 2.4916046e+01,
                    8.5044786e-02, 3.9141029e+01, 5.4358055e+01,
                    1.1465088e-01, 2.9013403e+01, 6.2002514e+01,
                    2.1055730e-01, 1.9359941e+01, 6.9314812e+01,
                    2.4464600e-01, 9.4432392e+00, 7.5357826e+01,
                    -1.1343049e+01, -2.5621631e+00, 5.4365078e+01,
                    -4.8847618e+00, -2.9789889e+00, 5.8262383e+01,
                    6.6776812e-02, -4.1521492e+00, 6.1156265e+01,
                    4.8336205e+00, -3.0266132e+00, 5.8240883e+01,
                    1.1361979e+01, -2.5426147e+00, 5.4354321e+01,
                    -4.4396172e+01, 3.8028950e+01, 2.9508656e+01,
                    -3.6802372e+01, 4.1966003e+01, 3.6441086e+01,
                    -2.7030066e+01, 4.2846291e+01, 3.8679180e+01,
                    -1.8099016e+01, 3.8054317e+01, 3.5227001e+01,
                    -2.8827501e+01, 3.4638760e+01, 3.7843975e+01,
                    -3.7548317e+01, 3.4137440e+01, 3.5662296e+01,
                    1.8693857e+01, 3.8392628e+01, 3.5799007e+01,
                    2.8203680e+01, 4.3019974e+01, 3.8273335e+01,
                    3.7267639e+01, 4.1548317e+01, 3.5709381e+01,
                    4.5420071e+01, 3.8107838e+01, 2.9145702e+01,
                    3.8283695e+01, 3.4362698e+01, 3.5057602e+01,
                    2.9689970e+01, 3.4457649e+01, 3.7568642e+01,
                    -2.5308142e+01, -2.8614902e+01, 4.2186726e+01,
                    -1.5573862e+01, -2.2598867e+01, 5.3897804e+01,
                    -6.3969536e+00, -1.8755230e+01, 5.9261024e+01,
                    3.9388917e-02, -1.9947508e+01, 6.0005688e+01,
                    7.8474569e+00, -1.8931816e+01, 5.8815735e+01,
                    1.7462221e+01, -2.2457047e+01, 5.2704235e+01,
                    2.5375256e+01, -2.8320356e+01, 4.1892509e+01,
                    1.8806950e+01, -3.1120468e+01, 4.8533150e+01,
                    1.1087898e+01, -3.3373093e+01, 5.4904701e+01,
                    5.6074157e-02, -3.4308014e+01, 5.7269211e+01,
                    -1.0917560e+01, -3.3384384e+01, 5.5001366e+01,
                    -1.8464451e+01, -3.0537933e+01, 4.8285717e+01,
                    -2.2263819e+01, -2.7849211e+01, 4.3452000e+01,
                    -8.4129391e+00, -2.5456505e+01, 5.3781532e+01,
                    -4.8454482e-02, -2.5865078e+01, 5.5222431e+01,
                    8.3201818e+00, -2.5526527e+01, 5.3793728e+01,
                    2.3563139e+01, -2.7790844e+01, 4.2452679e+01,
                    8.3718014e+00, -2.6039980e+01, 5.3205944e+01,
                    -2.6260696e-02, -2.6413929e+01, 5.4533428e+01,
                    -9.4196987e+00, -2.5974625e+01, 5.2579041e+01};
            };
        }
    }
}
#endif // TRUSTID_FACE_NORMALIZATION_H_
